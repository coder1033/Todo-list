(()=>{"use strict";var e=6e4;function t(t){return t.getTime()%e}function n(n){var a=new Date(n.getTime()),o=Math.ceil(a.getTimezoneOffset());a.setSeconds(0,0);var l=o>0?(e+t(a))%e:t(a);return o*e+l}function a(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function o(e){a(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function l(e){a(1,arguments);var t=o(e);return t.setHours(0,0,0,0),t}var i=864e5;const r=(()=>{let e=(e,t)=>{if(!e)return;let n=document.createElement("button");n.textContent=e.name,n.setAttribute("onclick",`manageDom.showTodo(${t})`);let a=document.createElement("li");a.appendChild(n),document.querySelector("#navbar").firstElementChild.appendChild(a)},t=(e,t)=>{let o=new Date,r=function(e,t){a(2,arguments);var o=l(e),r=l(t),d=o.getTime()-n(o),c=r.getTime()-n(r);return Math.round((d-c)/i)}(new Date(e.date),o),d=document.querySelector("#showcase");d.firstElementChild==d.lastElementChild&&d.appendChild(document.createElement("div"));let c=d.children[1],m=document.createElement("div");m.className=r>0?e.priority:"completed";let s=document.createTextNode(e.description),u=document.createElement("button");u.className="edit-delete-button",u.setAttribute("onclick",`manageForm.deleteTask(${t})`),u.textContent="delete";let p=document.createElement("button");p.className="edit-delete-button",p.setAttribute("onclick",`manageForm.editTask(${t}, "${e.description}", "${e.date}")`),p.textContent="edit";let g=document.createElement("div"),h=document.createElement("small");h.textContent=r>0?`${r} days left`:`${Math.abs(r)} days before`,g.appendChild(h),m.appendChild(s),m.appendChild(u),m.appendChild(p),m.appendChild(g),c.appendChild(m)},o=e=>{(e=>{let t=JSON.parse(localStorage.getItem("all_todo"))[e],n=document.querySelector("#showcase h2");n.childNodes[0].textContent=t.name,n.childNodes[1].textContent=" ("+t.description+")",n.childNodes[2].setAttribute("onclick",`manageForm.editTodo(${e}, "${t.name}", "${t.description}")`)})(e),(e=>{let t=document.querySelector("#addTask-deleteTodo");t.children[0].setAttribute("onclick",`manageForm.deleteTodo(${e})`),t.children[1].setAttribute("onclick",`manageForm.addTask(${e})`)})(e)},r=e=>{(()=>{let e=document.querySelector("#showcase");e.firstElementChild!==e.lastElementChild&&e.removeChild(e.lastElementChild)})(),JSON.parse(localStorage.all_todo)[e].tasks.forEach(t)};return{currentContent:o,currentNavbar:()=>{(()=>{let e=document.querySelector("#navbar ul");for(;1!==e.children.length;)e.removeChild(e.lastElementChild)})(),JSON.parse(localStorage.all_todo).forEach(e)},currentTasks:r,showTodo:e=>{localStorage.currentId=e,o(e),r(e)}}})();if(!localStorage.getItem("initiate")){localStorage.setItem("initiate",!0);let e={name:"default",description:"This is a default ToDo for sample",tasks:[]},t={description:"Sample task description 1",priority:"mid-priority",date:new Date},n={description:"Sample task description 2",priority:"completed",date:new Date},a={description:"Sample task description 3",priority:"high-priority",date:new Date},o={description:"Sample task description 4",priority:"low-priority",date:new Date};e.tasks.push(t,n,a,o),console.log([t,n,a,o]),console.log(e),localStorage.setItem("all_todo",JSON.stringify([e]))}const d={newTodo:e=>{let t=((e,t)=>{let n={name:e,description:t,tasks:[]},a=JSON.parse(localStorage.getItem("all_todo"));return a.push(n),localStorage.all_todo=JSON.stringify(a),a.length-1})(e.elements.name.value,e.elements.description.value);current.updateId(t)},editTodo:(e,t)=>{((e,t,n)=>{let a=JSON.parse(localStorage.getItem("all_todo"));a[e].name=t,a[e].description=n,localStorage.all_todo=JSON.stringify(a)})(t,e.elements.name.value,e.elements.description.value),current.updateId(t)},deleteTodo:e=>{(e=>{let t=JSON.parse(localStorage.all_todo);return t.splice(e,1),localStorage.all_todo=JSON.stringify(t),t.length})(e)?current.updateId(0):current.updateId(null)}},c={addTodo:()=>{document.getElementById("insert").innerHTML='<div id="show-form">\n                        <form action="">\n                            <h1>Add Todo</h1>\n                            <div>\n                                <label>Name</label><br>\n                                <input placeholder="Enter name" type="text" name="name" required minlength="4" maxlength="20" oninput="validate.validateEmpty(this)">\n                            </div>\n                            <div>\n                                <label>Description</label><br>\n                                <input placeholder="Enter description" type="text" name="description" required minlength="4" maxlength="100" oninput="validate.validateEmpty(this)">\n                            </div>\n                            <input type="submit" value="Add" name="submit" onclick="manageTodo.newTodo(this.form)">\n                            <button type="button" name="cancel" onclick="manageForm.cancelForm()">Cancel</button>\n                        </form>\n                    </div>'},editTodo:(e,t,n)=>{((e,t,n)=>{let a=`<div id="show-form">\n                    <form action="">\n                        <h1>Edit Todo</h1>\n                        <div>\n                            <label>Name</label><br>\n                            <input value=${t} type="text" name="name" required minlength="4" maxlength="20" oninput="validate.validateEmpty(this)">\n                        </div>\n                        <div>\n                            <label>Description</label><br>\n                            <input value="${n}" type="text" name="description" required minlength="4" maxlength="100" oninput="validate.validateEmpty(this)">\n                        </div>\n                        <input type="submit" value="Add" name="submit" onclick="manageTodo.editTodo(this.form, ${e})">\n                        <button type="button" name="cancel" onclick="manageForm.cancelForm()">Cancel</button>\n                    </form>\n                </div>`;document.getElementById("insert").innerHTML=a})(e,t,n)},deleteTodo:e=>{(e=>{let t=`<div id="show-form">\n                    <form action="">\n                        <h1>Delete Todo</h1>\n                        <div>\n                            <label>Are you sure you want to delete this ToDo</label><br>\n                            <input type="submit" value="Yes" name="" onclick="manageTodo.deleteTodo(${e})">\n                            <button type="button" name="No" onclick="manageForm.cancelForm()">Cancel</button>\n                        </div>\n                    </form>\n                </div>`;document.getElementById("insert").innerHTML=t})(e)},addTask:e=>{(e=>{let t=`<div id="show-form">\n                    <form action="">\n                        <h1>Add Task</h1>\n                        <div>\n                            <label>Task</label><br>\n                            <input placeholder="Enter task" type="text" name="description" required minlength="5" maxlength="100" oninput="validate.validateEmpty(this)">\n                        </div>\n                        <div>\n                            <label>Due Time</label><br>\n                            <input type="date" name="date" required>\n                        </div>\n                        <div>\n                            <label>Priority</label><br>\n                            <input type="radio" id="hp" name="priority" value="high-priority" required>\n                            <label for="hp">high</label>\n                            <input type="radio" id="mp" name="priority" value="mid-priority" required>\n                            <label for="mp">mid</label>\n                            <input type="radio" id="lp" name="priority" value="low-priority" required>\n                            <label for="lp">low</label>\n                        </div>\n                        <input type="submit" value="Add" name="" onclick="manageTask.addTask(this.form, ${e})">\n                        <button type="button" name="cancel" onclick="manageForm.cancelForm()">Cancel</button>\n                    </form>\n                </div>`;document.getElementById("insert").innerHTML=t})(e)},editTask:(e,t,n)=>{((e,t,n)=>{let a=`<div id="show-form">\n                    <form action="">\n                        <h1>Edit Task</h1>\n                        <div>\n                            <label>Task</label><br>\n                            <input value="${t}" type="text" name="description" required minlength="5" maxlength="100" oninput="validate.validateEmpty(this)">\n                        </div>\n                        <div>\n                            <label>Due Time</label><br>\n                            <input value="${n}" type="date" name="date" required>\n                        </div>\n                        <div>\n                            <input type="radio" id="hp" name="priority" value="high-priority" required>\n                            <label for="hp">high-priority</label>\n                            <input type="radio" id="mp" name="priority" value="mid-priority" required>\n                            <label for="mp">mid-priority</label>\n                            <input type="radio" id="lp" name="priority" value="low-priority" required>\n                            <label for="lp">low-priority</label>\n                        </div>\n                        <input type="submit" value="Add" name="" onclick="manageTask.editTask(this.form, ${e})">\n                        <button type="button" name="cancel" onclick="manageForm.cancelForm()">Cancel</button>\n                    </form>\n                </div>`;document.getElementById("insert").innerHTML=a})(e,t,n)},deleteTask:e=>{(e=>{let t=`<div id="show-form">\n                    <form action="">\n                        <h1>Delete Task</h1>\n                        <div>\n                            <label>Are you sure you want to delete this Task</label><br>\n                            <input type="submit" value="Yes" name="" onclick="manageTask.deleteTask(${e})">\n                            <button type="button" name="No" onclick="manageForm.cancelForm()">No</button>\n                        </div>\n                    </form>\n                </div>`;document.getElementById("insert").innerHTML=t})(e)},cancelForm:()=>{document.getElementById("insert").innerHTML=""}},m={addTask:(e,t)=>{((e,t)=>{let n={description:e.elements.description.value,date:e.elements.date.value,priority:e.elements.priority.value},a=JSON.parse(localStorage.all_todo);a[t].tasks.push(n),localStorage.all_todo=JSON.stringify(a)})(e,t)},editTask:(e,t)=>{((e,t)=>{let n=e.elements.description.value,a=e.elements.date.value,o=e.elements.priority.value,l=JSON.parse(localStorage.all_todo),i=l[localStorage.currentId].tasks[t];i.description=n,i.date=a,i.priority=o,localStorage.all_todo=JSON.stringify(l)})(e,t)},deleteTask:e=>{(e=>{let t=JSON.parse(localStorage.all_todo);t[localStorage.currentId].tasks.splice(e,1),localStorage.all_todo=JSON.stringify(t)})(e)}};window.manageForm=c,window.manageDom=r,window.manageTodo=d,window.manageTask=m,window.validate={validateEmpty:e=>{(e=>{/^\s/.test(e.value)&&(e.value="")})(e)}};const s=(localStorage.currentId||(localStorage.currentId=0),{currentContent:()=>{"null"!=localStorage.currentId&&r.currentContent(localStorage.currentId)},updateId:e=>{localStorage.currentId=e},currentNavbar:()=>{r.currentNavbar()},currentTasks:()=>{"null"!=localStorage.currentId&&r.currentTasks(localStorage.currentId)}});window.current=s,s.currentContent(),s.currentNavbar(),s.currentTasks()})();